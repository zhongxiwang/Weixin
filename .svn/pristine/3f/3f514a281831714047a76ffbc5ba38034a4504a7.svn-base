webpackJsonp([8],{H5e0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("mvHQ"),r=i.n(a),l=i("bOdI"),o=i.n(l),n={data:function(){var e;return e={slider:.5,sliderShow:!1,loading:!1,selectForm:{},formList:[],activeName:"first"},o()(e,"loading",!1),o()(e,"pageData",[]),o()(e,"fileList",[]),o()(e,"selectFormUrl",""),o()(e,"lxUrl",""),o()(e,"lcUrl",""),e},created:function(){console.log(this.$route),this.slider=.5,this.getAllPgeData(),this.loading=!0;var e=this;setTimeout(function(){e.loading=!1},4e3)},methods:{getSelectFormUrl:function(){var e=this.selectForm,t="http://218.94.36.101:8888/JnfjWebService/HtmlPage/HtmlMainPage.aspx?iid="+e.iid+"&FormName="+e.res_value+"&input_index="+e.input_index+"&rtid="+e.rtid+"&t="+Math.random();this.selectFormUrl=t},getLxUrl:function(){var e="http://218.94.36.101:8888/JnfjWebService/UserApplication/workflow/WorkItemDetails.aspx?iid="+this.$route.params.iid;this.lxUrl=e},getLcUrl:function(){var e="http://218.94.36.101:8888/JnfjWebService/htmlpage/ViewWorkflowProcess.aspx?iid="+this.$route.params.iid+"&sctlid=&ectlid=";this.lcUrl=e},getAllPgeData:function(){var e=this.$MyGlobal,t=this;t.loading=!0;var i=" and iid='"+t.$route.params.iid+"' order by sort";e.GetDataWebService("Handle.WorkHandle","GetResourceTreeAll",i,function(e){var i=JSON.parse(e);if(t.pageData=i,i.length<=0)return layer.msg("该案件存在异常！",function(e){t.$router.go(-1)}),!1;t.formList=i.filter(function(e){return"3"==e.type}),t.fileList=i.filter(function(e){return"2"==e.type}),t.selectForm=t.formList[0],t.getSelectFormUrl(),t.getLcUrl(),t.getLxUrl()},function(e){console.log(e),t.loading=!1})},triggerForm:function(e){this.selectForm=this.formList[e],this.slider=.5,this.getSelectFormUrl()},downFile:function(e){var t=this.$MyGlobal,i=this,a={type:["attachment a","dynamic_resource b"],pageNum:1,PageMax:1,fileds:"replace(substr(a.ftp_path,instr(a.ftp_path,'@',1,2)+1),'\\','/') as path",where:"a.aid=b.res_value and b.res_value='"+e.res_value+"'"},r=a.type.join(",");t.GetDataAjax("get",r,a,function(e){if(e.length>0){var t="http://218.94.36.101:8888/weixinpage/ftpfile/"+e[0].path;window.location.href=t}else layer.msg("找不到文件！")},function(e){i.loading2=!1,layer.alert("下载附件时发生异常！")})},SliderChange:function(e){var t={type:"slider",data:{SliderValue:e}};window.frames.myformiframe.contentWindow.postMessage(r()(t),"*")}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.loading,expression:"loading",modifiers:{lock:!0}}],staticClass:"viewbody",staticStyle:{position:"relative"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("el-tabs",{staticStyle:{width:"96%",margin:"0 auto",position:"relative",height:"100%"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"公文表单",name:"first"}},[i("el-main",{staticClass:"my-tab-panel-content"},[i("div",{staticClass:"my-tab-panel-body"},[i("div",{staticStyle:{position:"absolute",top:"5px",left:"0px","z-index":"1"}},e._l(e.formList,function(t,a){return e.formList&&e.formList.length>1?i("div",[0==a?i("el-button",{attrs:{size:"mini",icon:"el-icon-caret-top",circle:""},on:{click:function(t){e.triggerForm(a)}}}):e._e(),e._v(" "),1==a?i("el-button",{attrs:{size:"mini",icon:"el-icon-caret-bottom",circle:""},on:{click:function(t){e.triggerForm(a)}}}):e._e()],1):e._e()})),e._v(" "),i("iframe",{staticStyle:{width:"100%",display:"block",margin:"0 auto",border:"none",height:"100%"},attrs:{id:"myformiframe",src:e.selectFormUrl,onload:"var data = {type:'slider',data: { SliderValue:0.5 }};window.frames['myformiframe'].contentWindow.postMessage(JSON.stringify(data), '*');"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.sliderShow,expression:"sliderShow"}],staticStyle:{position:"absolute",top:"10px",bottom:"60px",right:"5px","z-index":"1"}},[i("el-slider",{staticStyle:{height:"100%"},attrs:{max:1,step:.01,size:"mini",vertical:""},on:{change:e.SliderChange},model:{value:e.slider,callback:function(t){e.slider=t},expression:"slider"}})],1),e._v(" "),i("div",{staticStyle:{position:"absolute",bottom:"15px",right:"10px","z-index":"1"}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-setting",circle:""},on:{click:function(t){e.sliderShow=!e.sliderShow}}})],1)])])],1),e._v(" "),i("el-tab-pane",{attrs:{label:"附件管理",name:"second"}},[i("el-table",{ref:"fileList",staticStyle:{width:"100%"},attrs:{data:e.fileList,size:"mini"}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"text",label:"附件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{"word-break":"break-all","word-wrap":"break-word"},on:{click:function(i){e.downFile(t.row)}}},[i("i",{staticClass:"el-icon-document",staticStyle:{color:"goldenrod"}}),e._v(" "),i("span",{staticStyle:{"margin-left":"10px","white-space":"normal"}},[e._v(e._s(t.row.text+t.row.icon))])])]}}])})],1)],1)],1)],1)},staticRenderFns:[]};var c=i("VU/8")(n,s,!1,function(e){i("h7ks")},null,null);t.default=c.exports},h7ks:function(e,t){}});
//# sourceMappingURL=8.4ded3ed1dfa6c1178b5d.js.map